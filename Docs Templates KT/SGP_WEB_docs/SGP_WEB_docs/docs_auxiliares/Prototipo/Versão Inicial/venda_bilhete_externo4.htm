<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>SGP WEB</title>
	<link rel="stylesheet" href="css/sgpweb.css">

	<script>
		
		function alterarPagamento(pagamento){
			if (pagamento.value == "D"){
				document.getElementById("vl_recebido").value = "";
				document.getElementById("vl_recebido").disabled = false;				
				document.getElementById("vl_troco").innerHTML = "0,00 R$";	
				document.getElementById("vl_troco").style.display = "inline";	
				document.getElementById("lb_troco").innerHTML = "Troco";	
				document.getElementById("cd_cliente").style.display = "none";		
			}else if (pagamento.value == "C"){
				document.getElementById("vl_recebido").value = "43,75 R$";
				document.getElementById("vl_recebido").disabled = true;
				document.getElementById("vl_troco").style.display = "none";			
				document.getElementById("lb_troco").innerHTML = "Cliente";	
				document.getElementById("cd_cliente").style.display = "inline";	
				
			}else{
				document.getElementById("vl_recebido").value = "43,75 R$";	
				document.getElementById("vl_recebido").disabled = true;				
				document.getElementById("vl_troco").innerHTML = "0,00 R$";	
				document.getElementById("vl_troco").style.display = "inline";						
				document.getElementById("lb_troco").innerHTML = "Troco";	
				document.getElementById("cd_cliente").style.display = "none";						
			}
		}


		function FormataReais(fld, milSep, decSep, e, maxLen) {
			var sep = 0;
			var key = '';
			var i = j = 0;
			var len = len2 = 0;
			var strCheck = '0123456789';
			var aux = aux2 = '';
			var whichCode = (window.Event) ? e.which : e.keyCode;
			if (whichCode == 13) return true;
			key = String.fromCharCode(whichCode);  // Valor para o código da Chave
			if (strCheck.indexOf(key) == -1) return false;  // Chave inválida
			len = fld.value.length;
			for(i = 0; i < len; i++)
				if ((fld.value.charAt(i) != '0') && (fld.value.charAt(i) != decSep)) break;
			aux = '';
			for(; i < len; i++)
				if (strCheck.indexOf(fld.value.charAt(i))!=-1) aux += fld.value.charAt(i);
			aux += key;
			len = aux.length;
			
			if (len > maxLen)
			{
				return false;
			}
			
			if (len == 0) fld.value = '';
			if (len == 1) fld.value = '0'+ decSep + '0' + aux;
			if (len == 2) fld.value = '0'+ decSep + aux;
			if (len > 2) {
			aux2 = '';
			for (j = 0, i = len - 3; i >= 0; i--) {
				if (j == 3) {
					aux2 += milSep;
					j = 0;
				}
				aux2 += aux.charAt(i);
				j++;
			}
			fld.value = '';
			len2 = aux2.length;
			for (i = len2 - 1; i >= 0; i--)
				fld.value += aux2.charAt(i);
				fld.value += decSep + aux.substr(len - 2, len);
			}
			return false;
		}		
		
		function Validator_Void(s)
		{
			var m = s.match(/^\s*(\S+(\s+\S+)*)\s*$/);
			return (m == null) ? "" : m[1];
		}

		function Validator_Currency(sender)
		{
			if(Validator_Void(sender.value) != "")
			{
				var intermed;
				var cleanInput;
				var exp = new RegExp("^\\s*([-\\+])?(((\\d+)\\.)*)(\\d+)(\\,(\\d{1,2}))?\\s*$");
				var num = sender.value.match(exp);
		
				if (num != null)
				{
					intermed = num[2] + num[5];
					cleanInput = num[1] + intermed.replace(new RegExp("(\\,)", "g"), "") + "." + num[7];
				}
				
				//Valida o separador de grupos de milhar (.)
				if (num != null)
				{
					var arrNum = intermed.split(".");
					for(var i = 1; i < arrNum.length;i++)
						if((arrNum[i].length == 2) || (arrNum[i].length > 3))
							num = null;
				}
		
				if (num != null)
					num = parseFloat(cleanInput);
				
				if ((isNaN(num)) || (num == null) )
				{
					alert("Valor inválido! (Ex. Formato: 1.000,00)");
					sender.focus();
					return false; 
				}
			}
			
			return true;
		}		
		
		function alterarTroco(sender){
			var troco = sender.value.replace('.','').replace(',','.') - 43.75;
			
			if (troco < 0){
				alert('O valor recebido é insuficiente!');
				sender.value = '';
				sender.focus();
				return false;
			}
			document.getElementById("vl_troco").innerHTML = troco + ' R$'
		}
		
		function cancelar(){
			if(confirm('Deseja realmente cancelar a venda?')){
				window.location = 'venda_bilhete_externo1.htm';
			}
		}		
	</script>
    <style type="text/css">
<!--
.style1 {font-size: 12px}
.style5 {font-size: 9px}
.style12 {font-size: 11px}
.style13 {font-size: 11px; font-weight: bold; }
-->
    </style>
</head>

<body>
<table width="80%" border="0" align="center" cellpadding="0" cellspacing="0">
  <tr>
    <td align="left" valign="middle" colspan="3">&nbsp;</td>
  </tr>   
  <tr>
    <td width="73%" height="30" align="left" valign="middle" class="linhaHeader"><div align="left" class="style1"><u>Venda de passagens &gt;&gt; Clientes Externos &gt;&gt; Pagamento </u></div></td>
    <td width="13%" nowrap="nowrap" class="linhaHeader style5"><div align="right">Outras vendas: </div></td>
    <td width="14%" nowrap="nowrap" class="linhaHeader"><div align="right"><span class="style5"><a href="venda_bilhete_funcionario1.htm">Funcion&aacute;rios/Aposentados</a> <br />
          <a href="venda_bilhete_nremunerado1.htm">N&atilde;o Remunerada</a></span></div></td>
  </tr>
  <tr>
    <td align="left" valign="middle" colspan="3"><hr/></td>
  </tr>
  <tr>
    <td align="left" valign="middle" colspan="3">&nbsp;</td>
  </tr>   
  <tr>
    <td align="left" valign="middle" colspan="3"><table width="80%" height="100%" border="0" align="center" cellpadding="0" cellspacing="0">
      <tr class="tableOddLineSmall">
        <td nowrap="nowrap"><div align="center"><strong>Descri&ccedil;&atilde;o</strong></div></td>
        <td nowrap="nowrap"><div align="center"><strong>Classe</strong></div></td>
        <td nowrap="nowrap"><div align="center"><strong>QTD</strong></div></td>
        <td nowrap="nowrap"><div align="center"><strong>Valor Un. </strong></div></td>
        <td nowrap="nowrap"><div align="center"><strong>Total </strong></div></td>
      </tr>
      <tr>
        <td width="32%" nowrap="nowrap" class="texto"><div align="left" class="style12">Adulto</div></td>
        <td width="19%" nowrap="nowrap" class="texto style12"><div align="center">Econ&ocirc;mica</div></td>
        <td width="11%" nowrap="nowrap" class="texto"><div align="center" class="style12">2</div></td>
        <td width="18%" nowrap="nowrap" class="texto"><div align="right" class="style12">17,50 R$</div></td>
        <td width="20%" nowrap="nowrap" class="texto"><div align="right" class="style12">35,00 R$</div></td>
      </tr>
      <tr>
        <td nowrap="nowrap" class="texto"><div align="left" class="style12">Estudante</div></td>
        <td nowrap="nowrap" class="texto style12"><div align="center">Econ&ocirc;mica</div></td>
        <td nowrap="nowrap" class="texto"><div align="center" class="style12">1</div></td>
        <td nowrap="nowrap" class="texto"><div align="right" class="style12">8,75 R$</div></td>
        <td nowrap="nowrap" class="texto"><div align="right" class="style12">8,75 R$</div></td>
      </tr>
      <tr>
        <td colspan="5" nowrap="nowrap" class="texto"><hr /></td>
      </tr>
      <tr>
        <td colspan="4" nowrap="nowrap" class="texto"><div align="left" class="style12">Total</div></td>
        <td nowrap="nowrap" class="texto"><div align="right" class="style13">43,75 R$</div></td>
      </tr>
    </table></td>
  </tr>    
  <tr>
    <td align="left" valign="middle" colspan="3">&nbsp;</td>
  </tr>  
  <tr>
    <td align="left" valign="middle" colspan="3"><table width="60%" height="100%" border="0" align="center" cellpadding="0" cellspacing="0">
      <tr class="tableOddLineSmall">
        <td nowrap="nowrap"><div align="center"><strong>Forma de Pagamento </strong></div></td>
        <td nowrap="nowrap"><div align="center"><strong>Total</strong></div></td>
        <td nowrap="nowrap"><div align="center"><strong>Valor Recebido (R$)</strong></div>         </td>
        <td nowrap="nowrap" align="center" style="font-weight:bold;" ><div id="lb_troco">Troco</div></td>
      </tr>
      <tr>
        <td width="32%" nowrap="nowrap" class="texto"><div align="left" class="style12">
          <div align="center">
            <select name="select" class="textoDestacado" onchange="alterarPagamento(this)">
              <option value="D" selected="selected">Dinheiro</option>
              <option value="CC">Cart&atilde;o de Cr&eacute;dito</option>
              <option value="CD">Cart&atilde;o de D&eacute;bito</option>
              <option value="C">Conta Corrente</option>
            </select>
          </div>
        </div></td>
        <td width="19%" nowrap="nowrap" class="texto style12"><div align="center">43,75 R$ </div></td>
        <td nowrap="nowrap" class="texto">
          <div align="center">
            <input name="vl_recebido" type="text" class="textoDestacado" id="vl_recebido" size="20" onKeyPress="return(FormataReais(this,'.',',',event))" onBlur='Validator_Currency(this);alterarTroco(this)'/>
            </div>
        </td>
        <td nowrap="nowrap" class="texto style12" align="center"><div id="vl_troco" >0,00 R$ </div><input name="cd_cliente" type="text" class="textoDestacado" id="cd_cliente" value="" size="20" style="display:none;" /></td>
      </tr>

    </table></td>
  </tr>    
  <tr>
    <td align="left" valign="middle" colspan="3">&nbsp;</td>
  </tr>   
    <tr>
    <td align="center" valign="middle" colspan="3"><input type="image" name="imageField" src="img/bt_voltar.gif" onclick="history.go(-1)" />
		  &nbsp;&nbsp;&nbsp;<input type="image" name="imageField4" src="img/bt_concluir.gif" onclick="javascript:alert('Venda Concluída com Sucesso!');window.location = 'venda_bilhete_externo1.htm'" />&nbsp;&nbsp;&nbsp;
		  <img name="imageField2" src="img/bt_cancelar.gif" onclick="cancelar()"/></td>
  </tr>    
</table>

</body>
</html>
